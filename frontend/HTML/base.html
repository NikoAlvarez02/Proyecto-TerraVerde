{% load static %}
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>{% block title %}Gestión | TerraVerde{% endblock %}</title>

    <link rel="icon" type="image/png" href="{% static 'ASSETS/terraverde.png' %}">
    <link rel="stylesheet" href="{% static 'CSS/styleturno.css' %}">
    {% block extra_css %}{% endblock %}
     
</head>
<body>
    <header class="topbar">
        <button class="menu-icon" aria-label="Abrir menú">
            <img src="{% static 'ASSETS/logo.png' %}" alt="Menú" width="26" height="26">
        </button>
        <a href="{% url 'home' %}" class="menu-icon" aria-label="Inicio" title="Inicio" style="margin-left:6px; display:inline-flex; align-items:center; justify-content:center;">
            <span style="font-size:18px;" aria-hidden="true">🏠</span>
        </a>
        {% if request.user.is_authenticated and request.user.perfil and request.user.perfil.puede_ver_calendario %}
        <a href="{% url 'turnos:list' %}" class="menu-icon" aria-label="Turnos" title="Turnos" style="margin-left:6px; display:inline-flex; align-items:center; justify-content:center;">
            <span style="font-size:18px;" aria-hidden="true">📅</span>
        </a>
        {% endif %}
        {% if request.user.is_authenticated and request.user.perfil and request.user.perfil.puede_ver_pacientes %}
        <a href="{% url 'pacientes:list' %}" class="menu-icon" aria-label="Pacientes" title="Pacientes" style="margin-left:6px; display:inline-flex; align-items:center; justify-content:center;">
            <span style="font-size:18px;" aria-hidden="true">👤</span>
        </a>
        {% endif %}
        {% if request.user.is_authenticated and request.user.perfil %}
            {% if request.user.perfil.puede_generar_reportes or request.user.perfil.puede_ver_estadisticas %}
            <a href="{% url 'reportes:dashboard' %}" class="menu-icon" aria-label="Reportes" title="Reportes" style="margin-left:6px; display:inline-flex; align-items:center; justify-content:center;">
                <span style="font-size:18px;" aria-hidden="true">📊</span>
            </a>
            {% endif %}
        {% endif %}
        {% if request.user.is_authenticated and request.user.perfil and request.user.perfil.puede_ver_estadisticas %}
        <a href="{% url 'satisfaccion:list' %}" class="menu-icon" aria-label="Satisfacción" title="Satisfacción" style="margin-left:6px; display:inline-flex; align-items:center; justify-content:center;">
            <span style="font-size:18px;" aria-hidden="true">😊</span>
        </a>
        {% endif %}
        <h2 class="app-title">{% block topbar_title %}Gestionar Sistema{% endblock %}</h2>
        <form method="post" action="{% url 'logout' %}" class="logout-form">
            {% csrf_token %}
            <button type="submit" class="btn-logout">Cerrar Sesión</button>
        </form>
    </header>

    <main class="main-wrap">
        <nav class="sidebar" id="sidebar">
            <h3>Módulos</h3>
            {% if request.user.is_authenticated and request.user.perfil and request.user.perfil.puede_ver_calendario %}<a href="{% url 'turnos:list' %}">Turnos</a>{% endif %}
            {% if request.user.is_authenticated and request.user.perfil and request.user.perfil.puede_ver_pacientes %}<a href="{% url 'pacientes:list' %}">Pacientes</a>{% endif %}
            <a href="{% url 'historias:historia' %}">Historias Clínicas</a>

            <a href="{% url 'admin_mod' %}">Administración</a>
            <a href="{% url 'home' %}">Volver al Inicio</a>
        </nav>

        <section class="contenido-principal">
            {% block content %}
            {% endblock %}
        </section>
    </main>

    <footer class="site-footer">
        <p>©2025 Centro Psicopedagógico. Todos los derechos reservados.</p>
    </footer>

    <script>
        const menuBtn = document.querySelector(".menu-icon");
        const sidebar = document.getElementById("sidebar");
        if (menuBtn && sidebar) {
            menuBtn.addEventListener("click", () => sidebar.classList.toggle("active"));
        }
    </script>

    {% block extra_js %}{% endblock %}

</body>
</html>

